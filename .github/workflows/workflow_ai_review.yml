name: Gemini AI Code Review

# PRì´ ìƒì„±ë˜ê±°ë‚˜, ìƒˆë¡œìš´ ì»¤ë°‹ì´ í‘¸ì‹œë  ë•Œ ì‹¤í–‰ë©ë‹ˆë‹¤.
on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  review:
# PRì— 'AI-Review'ë¼ëŠ” ë ˆì´ë¸”ì´ í¬í•¨ë˜ì–´ ìˆì„ ë•Œë§Œ ì‹¤í–‰ë©ë‹ˆë‹¤.
    if: contains(github.event.pull_request.labels.*.name, 'ai_review')

    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write # PRì— ëŒ“ê¸€ì„ ë‹¬ê¸° ìœ„í•´ í•„ìš”í•©ë‹ˆë‹¤.

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Gemini AI Review
        # ê²€ì¦ëœ ì»¤ë®¤ë‹ˆí‹° ì•¡ì…˜ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
        uses: sshnaidm/gemini-code-review-action@v1
        with:
          gemini-key: ${{ secrets.GEMINI_API_KEY }}
          model: "gemini-3-flash-preview" # ì†ë„ì™€ ë¹„ìš© ë©´ì—ì„œ íš¨ìœ¨ì ì¸ flash ëª¨ë¸ ì¶”ì²œ
          # íŒ€ì˜ ì„±ê²©ì— ë§ê²Œ í”„ë¡¬í”„íŠ¸ë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
          prompt: |
            You are a seasoned AI Engineer acting as a code reviewer. Your task is to analyze the provided Git-style unified code diffs and provide a review under the following guidelines:
            - Bug & Performance:
              Identify potential bugs, edge cases, and performance bottlenecks.
              If surrounding context is missing, clearly state assumptions and avoid speculative conclusions.
            - Quality & Clean Code:
              Evaluate readability, naming, structure, and adherence to Clean Code principles.
              Avoid purely subjective style preferences unless they affect maintainability or correctness.
            - Actionable Feedback:
              Provide concrete, improved code snippets for each suggested change.
            - Severity:
              Label each issue with one of: [Critical], [Major], [Minor], [Nit].
            - Output Format:
              Structure the review using the following sections:
              1. ğŸ”´ Potential Bugs
              2. âš¡ Performance Concerns
              3. ğŸ§¹ Code Quality & Clean Code
              4. âœ… Suggested Improvements (with code snippets)
            - Language:
              Write the entire review in Korean.
            - Exception:
              Skip any analysis of the `workflow_ai_review.yml` file entirely.