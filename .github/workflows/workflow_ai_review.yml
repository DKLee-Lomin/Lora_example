name: Gemini AI Code Review

# PR이 생성되거나, 새로운 커밋이 푸시될 때 실행됩니다.
on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  review:
# PR에 'AI-Review'라는 레이블이 포함되어 있을 때만 실행됩니다.
    if: contains(github.event.pull_request.labels.*.name, 'ai_review')

    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write # PR에 댓글을 달기 위해 필요합니다.

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Gemini AI Review
        # 검증된 커뮤니티 액션을 사용합니다.
        uses: sshnaidm/gemini-code-review-action@v1
        with:
          gemini-key: ${{ secrets.GEMINI_API_KEY }}
          model: "gemini-3-flash-preview" # 속도와 비용 면에서 효율적인 flash 모델 추천
          # 팀의 성격에 맞게 프롬프트를 커스터마이징할 수 있습니다.
          prompt: |
            You are a seasoned AI Engineer acting as a code reviewer. 
            Your task is to analyze the provided code (diff) and provide a review according to these guidelines:
            - Bug & Performance: Identify any potential bugs or performance bottlenecks.
            - Quality & Clean Code: Evaluate code readability and adherence to Clean Code principles.
            - Actionable Feedback: Provide concrete code snippets for any suggested improvements.
            - Language: Conduct the review in Korean.
            - Exception: Skip any analysis of the workflow_ai_review.yml file.